---
description: 通院用レポート作成機能の実装（A4印刷対応）
---

# 通院用レポート機能 実装計画

ユーザーの要望に基づき、医師への提出用にデータをまとめたレポート画面を作成する。

## 1. ページ構成

- **URL**: `/report`
- **機能**:
  - 指定期間（デフォルト: 前回の通院日 〜 今日）のデータを集計して表示。
  - 印刷ボタンを押すとブラウザの印刷ダイアログを起動。
  - 印刷用 CSS (`@media print`) を適用し、余計な UI（ヘッダー、サイドバー等）を非表示にする。

## 2. 実装ファイル

### `src/app/report/page.tsx`

- **Layout**: A4 縦サイズを意識したレイアウト。
- **Components**:
  - **Header**: 患者情報（名前）、対象期間、出力日
  - **Summary**: 期間中のハイライト（気分平均、睡眠平均、特記事項）
  - **Chart**: 睡眠時間と気分の推移グラフ (Recharts を使用)
  - **Medication Check**: 飲み忘れがあった日、頓服の使用回数・タイミング
  - **Symptom & Memo**: よく出た症状、記録されたフリーメモの抜粋

### `src/app/stats/page.tsx`

- 「医師用レポート作成」ボタンを追加。
- クリック時に期間設定（簡易）を行い、`/report` へ遷移させる。

## 3. 手順

1. `src/app/report/page.tsx` を作成し、ダミーデータでレイアウトを組む。
2. 実際のデータ (Dexie DB) を読み込むロジックを実装。
3. `recharts` を使ってグラフを描画（白黒印刷でも見やすい配色にする）。
4. 印刷用スタイル (`print:hidden`, `print:block` 等) を調整。
5. 統計ページからのリンクを追加。

## 4. 留意点

- 医学的判断を含む表現は避け、客観的なデータ（ログ）の提示に徹する。
- 印刷時のインク節約のため、背景色は白、文字は黒を基調とする。
